<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaniAI - Complete Prototype</title>
    <style>
        /* Identical CSS as before ‚Äì no changes needed */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 100%;
            padding: 20px;
        }
        .screen {
            display: none;
            padding: 20px;
            animation: fadeIn 0.3s ease-in-out;
        }
        .screen.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }
        .logo svg {
            width: 40px;
            height: 40px;
            fill: white;
        }
        h1 {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 700;
        }
        h2 {
            font-size: 1.5rem;
            color: #3498db;
            margin-bottom: 20px;
            font-weight: 600;
        }
        h3 {
            font-size: 1.2rem;
            margin: 15px 0 10px;
            color: #2c3e50;
            font-weight: 600;
        }
        h4 {
            font-size: 1.1rem;
            margin: 15px 0 10px;
            color: #27ae60;
            font-weight: 600;
        }
        p {
            font-size: 1rem;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.2s ease;
            box-shadow: 0 3px 10px rgba(79, 172, 254, 0.3);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn-secondary {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            box-shadow: 0 3px 10px rgba(155, 89, 182, 0.3);
        }
        .btn-secondary:hover {
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.4);
        }
        .btn-emergency {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            box-shadow: 0 3px 10px rgba(231, 76, 60, 0.3);
        }
        .btn-emergency:hover {
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        .symptom-container {
            margin-bottom: 20px;
        }
        .symptom-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: all 0.2s ease;
            border: 1px solid #ecf0f1;
        }
        .symptom-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-color: #3498db;
        }
        .symptom-icon {
            width: 40px;
            height: 40px;
            background: #ecf0f1;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: #3498db;
            font-size: 1.2rem;
            transition: all 0.2s;
        }
        .symptom-item:hover .symptom-icon {
            background: #3498db;
            color: white;
        }
        .symptom-label {
            flex: 1;
            font-size: 1rem;
            font-weight: 500;
        }
        .checkbox {
            width: 22px;
            height: 22px;
            accent-color: #3498db;
            cursor: pointer;
        }
        .result-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            border: 1px solid #ecf0f1;
        }
        .diagnosis-title {
            font-size: 1.3rem;
            color: #e74c3c;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f1c40f;
        }
        .advice-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #27ae60;
        }
        .advice-title {
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        .map-container {
            height: 300px;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border: 1px solid #ecf0f1;
        }
        .health-center {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border: 1px solid #ecf0f1;
            transition: all 0.2s ease;
        }
        .health-center:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .center-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        .center-address {
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        .center-phone {
            color: #3498db;
            font-weight: bold;
            font-size: 1rem;
        }
        .disclaimer {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            font-size: 0.9rem;
            box-shadow: 0 3px 10px rgba(231, 76, 60, 0.3);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        .location-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            font-size: 1rem;
            margin: 20px 0;
            transition: all 0.3s;
            font-weight: 500;
        }
        .location-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #ecf0f1;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .back-btn {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            margin-top: 10px;
            box-shadow: 0 3px 10px rgba(149, 165, 166, 0.3);
        }
        .back-btn:hover {
            box-shadow: 0 5px 15px rgba(149, 165, 166, 0.4);
        }
        .emergency-menu, .prevention-menu {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .emergency-card, .prevention-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #ecf0f1;
        }
        .emergency-card:hover, .prevention-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: #3498db;
        }
        .emergency-icon, .prevention-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }
        .tab-menu {
            display: flex;
            margin-bottom: 20px;
            overflow-x: auto;
            gap: 5px;
            padding-bottom: 10px;
        }
        .tab-btn {
            padding: 12px 20px;
            background: #ecf0f1;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            white-space: nowrap;
            font-weight: 600;
            transition: all 0.2s;
            border-radius: 8px 8px 0 0;
            flex: 1;
            text-align: center;
            min-width: 100px;
        }
        .tab-btn.active {
            background: #3498db;
            color: white;
            border-bottom: 3px solid #2980b9;
            box-shadow: 0 2px 5px rgba(52, 152, 219, 0.2);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        /* Prevention-specific styles */
        .prevention-title {
            text-align: center;
            margin: 25px 0 30px;
            color: #1B5E20;
            font-size: 1.8rem;
            font-weight: 700;
        }
        .fluid-button {
            background-color: white;
            border: 2px solid #4CAF50;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        .fluid-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.12);
            background-color: #F1F8E9;
            border-color: #388E3C;
        }
        .fluid-button:active {
            transform: translateY(0);
        }
        .button-icon {
            width: 50px;
            height: 50px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            font-size: 1.5rem;
            transition: all 0.2s;
        }
        .fluid-button:hover .button-icon {
            background-color: #388E3C;
        }
        .button-content {
            flex: 1;
        }
        .button-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #1B5E20;
            margin-bottom: 5px;
        }
        .button-description {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }
        .result-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            animation: slideUp 0.3s ease;
            border: 1px solid #ecf0f1;
        }
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .close-modal:hover {
            background: #f8f9fa;
            color: #e74c3c;
        }
        .modal-title {
            font-size: 1.4rem;
            color: #1B5E20;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4CAF50;
            font-weight: 600;
        }
        .modal-content p {
            margin-bottom: 15px;
            line-height: 1.7;
        }
        .modal-content ol, .modal-content ul {
            margin-bottom: 15px;
            padding-left: 20px;
        }
        .modal-content li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        .prevention-loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        .prevention-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left: 4px solid #4CAF50;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            h1 {
                font-size: 1.6rem;
            }
            .btn {
                padding: 14px;
                font-size: 1.05rem;
            }
            .emergency-menu, .prevention-menu {
                grid-template-columns: 1fr;
            }
            .logo {
                width: 70px;
                height: 70px;
            }
            .logo svg {
                width: 35px;
                height: 35px;
            }
        }
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            h1 {
                font-size: 1.5rem;
            }
            h2 {
                font-size: 1.3rem;
            }
            .btn {
                padding: 12px;
                font-size: 1rem;
            }
            .symptom-item {
                padding: 12px;
            }
            .symptom-icon {
                width: 35px;
                height: 35px;
                font-size: 1.1rem;
            }
            .result-container {
                padding: 20px;
            }
            .tab-btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            .button-title {
                font-size: 1.1rem;
            }
            .modal-content {
                padding: 20px;
            }
        }
        /* Performance optimizations */
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        * {
            -webkit-tap-highlight-color: transparent;
        }
        img, iframe {
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
        }
        /* Animation performance */
        .btn, .symptom-item, .emergency-card, .fluid-button, .health-center {
            will-change: transform, box-shadow;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Disclaimer visible on all pages -->
        <div class="disclaimer">
            ‚ö†Ô∏è WARNING: This prototype is a simulation and must NEVER be used for real medical advice. Always consult a healthcare professional for any medical issue.
        </div>
        <!-- Home Screen -->
        <div id="home-screen" class="screen active">
            <div class="header">
                <div class="logo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                    </svg>
                </div>
                <h1>SaniAI</h1>
                <p>Your intelligent health assistant for Africa</p>
                <p>Fast diagnosis and region-adapted advice</p>
                <p>Created by MUPOLE UWIZEYE ALEXIS</p>
            </div>
            <div class="tab-menu">
                <button class="tab-btn active" data-tab="diagnosis">Diagnosis</button>
                <button class="tab-btn" data-tab="emergency">Emergencies</button>
                <button class="tab-btn" data-tab="prevention">Prevention</button>
            </div>
            <div id="diagnosis-tab" class="tab-content active">
                <button id="start-btn" class="btn">Start Diagnosis</button>
            </div>
            <div id="emergency-tab" class="tab-content">
                <h3>üÜò First Aid Guide</h3>
                <div class="emergency-menu">
                    <div class="emergency-card" data-emergency="snake-bite">
                        <div class="emergency-icon">üêç</div>
                        <p>Snake Bite</p>
                    </div>
                    <div class="emergency-card" data-emergency="dog-bite">
                        <div class="emergency-icon">üêï</div>
                        <p>Dog Bite</p>
                    </div>
                    <div class="emergency-card" data-emergency="heart-attack">
                        <div class="emergency-icon">‚ù§Ô∏è</div>
                        <p>Heart Attack</p>
                    </div>
                    <div class="emergency-card" data-emergency="epilepsy">
                        <div class="emergency-icon">üß†</div>
                        <p>Epilepsy</p>
                    </div>
                    <div class="emergency-card" data-emergency="stroke">
                        <div class="emergency-icon">ü©∫</div>
                        <p>Stroke</p>
                    </div>
                    <div class="emergency-card" data-emergency="burn">
                        <div class="emergency-icon">üî•</div>
                        <p>Burn</p>
                    </div>
                    <div class="emergency-card" data-emergency="choking">
                        <div class="emergency-icon">üòÆ</div>
                        <p>Choking</p>
                    </div>
                    <div class="emergency-card" data-emergency="fracture">
                        <div class="emergency-icon">ü¶¥</div>
                        <p>Fracture</p>
                    </div>
                </div>
            </div>
            <div id="prevention-tab" class="tab-content">
                <h3 class="prevention-title">Protect Your Health and Your Family</h3>
                <div class="prevention-menu">
                    <div class="fluid-button" data-prevention="malaria">
                        <div class="button-icon">ü¶ü</div>
                        <div class="button-content">
                            <div class="button-title">Malaria Prevention</div>
                            <div class="button-description">Learn how to protect yourself from mosquitoes</div>
                        </div>
                    </div>
                    <div class="fluid-button" data-prevention="diabetes">
                        <div class="button-icon">üç¨</div>
                        <div class="button-content">
                            <div class="button-title">Diabetes Prevention</div>
                            <div class="button-description">Adopt healthy eating habits</div>
                        </div>
                    </div>
                    <div class="fluid-button" data-prevention="snake-bite">
                        <div class="button-icon">üêç</div>
                        <div class="button-content">
                            <div class="button-title">Snake Bites</div>
                            <div class="button-description">Act quickly in case of a bite</div>
                        </div>
                    </div>
                    <div class="fluid-button" data-prevention="child-accidents">
                        <div class="button-icon">üë∂</div>
                        <div class="button-content">
                            <div class="button-title">Child Accidents</div>
                            <div class="button-description">Keep your children safe at home</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Diagnosis Screen -->
        <div id="diagnostic-screen" class="screen">
            <h2>Self-Diagnosis</h2>
            <p>Please select your symptoms:</p>
            <input type="text" id="location-input" class="location-input" placeholder="Enter your location (e.g., Uganda, Kamuli district)" value="Uganda, Kamuli district">
            <div class="symptom-container">
                <div class="symptom-item">
                    <div class="symptom-icon">üå°Ô∏è</div>
                    <label class="symptom-label">Fever or chills</label>
                    <input type="checkbox" class="checkbox" data-symptom="fever">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">ü§ï</div>
                    <label class="symptom-label">Severe headache</label>
                    <input type="checkbox" class="checkbox" data-symptom="headache">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">ü§¢</div>
                    <label class="symptom-label">Nausea or vomiting</label>
                    <input type="checkbox" class="checkbox" data-symptom="nausea">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">üí™</div>
                    <label class="symptom-label">Muscle pain</label>
                    <input type="checkbox" class="checkbox" data-symptom="muscle pain">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">üò¥</div>
                    <label class="symptom-label">Extreme fatigue</label>
                    <input type="checkbox" class="checkbox" data-symptom="fatigue">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">ü©∏</div>
                    <label class="symptom-label">Unusual bleeding</label>
                    <input type="checkbox" class="checkbox" data-symptom="bleeding">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">ü§ß</div>
                    <label class="symptom-label">Cough or breathing difficulties</label>
                    <input type="checkbox" class="checkbox" data-symptom="cough">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">üíß</div>
                    <label class="symptom-label">Diarrhea</label>
                    <input type="checkbox" class="checkbox" data-symptom="diarrhea">
                </div>
            </div>
            <button id="submit-diagnosis" class="btn">Analyze My Symptoms</button>
            <button id="back-to-home" class="btn back-btn">Back</button>
        </div>
        <!-- Loading Screen -->
        <div id="loading-screen" class="screen">
            <div class="loading">
                <div class="spinner"></div>
                <p>Analysis in progress... Our AI is evaluating your symptoms</p>
                <p>This may take a few seconds</p>
            </div>
        </div>
        <!-- Results Screen -->
        <div id="result-screen" class="screen">
            <h2>Diagnosis Results</h2>
            <div class="result-container">
                <div class="diagnosis-title" id="diagnosis-title">Preliminary Diagnosis</div>
                <div id="diagnosis-content">
                    <!-- AI-generated content will be inserted here -->
                </div>
                <div class="advice-section">
                    <div class="advice-title">üìã Recommended Action Plan:</div>
                    <div id="advice-content">
                        <!-- AI-generated advice will be inserted here -->
                    </div>
                </div>
            </div>
            <button id="view-services" class="btn">Find Nearby Health Services</button>
            <button id="new-diagnosis" class="btn back-btn">New Diagnosis</button>
        </div>
        <!-- Emergency Advice Screen -->
        <div id="emergency-advice-screen" class="screen">
            <h2 id="emergency-title">Emergency First Aid</h2>
            <div class="result-container">
                <div id="emergency-content">
                    <!-- Emergency advice content will be inserted here -->
                </div>
            </div>
            <button id="back-to-emergency-menu" class="btn back-btn">Back to Emergency Guide</button>
            <button id="emergency-services" class="btn btn-emergency">Find Emergency Services</button>
        </div>
        <!-- Prevention Advice Modal -->
        <div class="result-modal" id="preventionModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closePreventionModal()">&times;</button>
                <h2 class="modal-title" id="preventionModalTitle">Prevention Tips</h2>
                <div id="preventionModalContent">
                    <!-- Content will be inserted here by JavaScript -->
                </div>
                <button class="btn back-btn" onclick="closePreventionModal()" style="margin-top: 15px;">Close</button>
            </div>
        </div>
        <!-- Prevention Loading -->
        <div class="prevention-loading" id="preventionLoading">
            <div class="prevention-spinner"></div>
            <p>Searching for personalized advice...</p>
        </div>
        <!-- Services Screen -->
        <div id="services-screen" class="screen">
            <h2>Nearby Health Services</h2>
            <p>Here are medical centers near <span id="user-location-display"></span></p>
            <div class="map-container">
                <iframe id="map-iframe" width="100%" height="100%" frameborder="0" style="border:0" allowfullscreen></iframe>
            </div>
            <div id="health-centers-list">
                <!-- Health centers list will be generated here -->
            </div>
            <button id="back-to-result" class="btn back-btn">Back to Results</button>
        </div>
    </div>
    <script>
        // Performance optimization - defer non-critical operations
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize app after page load
            initApp();
        });
        function initApp() {
            // Gemini API Key
            const GEMINI_API_KEY = "AIzaSyCitXohWZsQ1ZiJRWunf6pJ80-B-PE5jPg";
            const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`;
            // Simulated geolocation
            let userLocation = "Uganda, Kamuli district";
            // Simulated database of health centers
            const healthCenters = [
                {
                    name: "Kamuli Health Center",
                    address: "Kamuli Town, Uganda",
                    phone: "+256 456 789 012",
                    lat: 0.9275,
                    lng: 33.1181
                },
                {
                    name: "St. Joseph Hospital",
                    address: "Buluya, Kamuli District",
                    phone: "+256 456 789 013",
                    lat: 0.9562,
                    lng: 33.1458
                },
                {
                    name: "Iringa Rural Clinic",
                    address: "Iringa Village, Kamuli",
                    phone: "+256 456 789 014",
                    lat: 0.8954,
                    lng: 33.0876
                },
                {
                    name: "Nawanyago Dispensary",
                    address: "Nawanyago, Kamuli District",
                    phone: "+256 456 789 015",
                    lat: 0.9123,
                    lng: 33.1765
                }
            ];
            // Emergency advice database
            const emergencyAdvice = {
                "snake-bite": {
                    title: "First Aid ‚Äì Snake Bite",
                    content: `
                        <p><strong>‚ö†Ô∏è IMMEDIATE ACTION REQUIRED:</strong></p>
                        <ol>
                            <li>Keep the person calm and still. Movement increases venom spread.</li>
                            <li>Remove tight clothing or jewelry near the bite area.</li>
                            <li>Keep the bitten area below heart level if possible.</li>
                            <li>Gently clean the wound with soap and water if available.</li>
                            <li>Apply a loose bandage above the bite (not too tight ‚Äì you should fit one finger underneath).</li>
                            <li>DO NOT cut the wound, suck out venom, apply ice, or use a tourniquet.</li>
                            <li>Go immediately to a hospital ‚Äì antivenom may be needed.</li>
                            <li>If safe, take a photo of the snake to help with identification.</li>
                        </ol>
                        <p><strong>Prevention:</strong></p>
                        <ul>
                            <li>Wear boots when walking through grassy areas</li>
                            <li>Use a flashlight at night</li>
                            <li>Be cautious when picking up wood or reaching into dark areas</li>
                        </ul>
                    `
                },
                "dog-bite": {
                    title: "First Aid ‚Äì Dog Bite",
                    content: `
                        <p><strong>‚ö†Ô∏è IMMEDIATE ACTION REQUIRED:</strong></p>
                        <ol>
                            <li>Immediately wash the wound with soap and running water for at least 5 minutes.</li>
                            <li>Apply gentle pressure with a clean cloth to stop bleeding.</li>
                            <li>Apply antibiotic ointment if available.</li>
                            <li>Cover with a sterile bandage.</li>
                            <li>Seek medical care immediately ‚Äì a rabies vaccine may be needed.</li>
                            <li>Try to get information about the dog‚Äôs vaccination status if possible.</li>
                            <li>Report the bite to local animal control authorities.</li>
                        </ol>
                        <p><strong>Watch for signs of infection:</strong> redness, swelling, increased pain, fever.</p>
                    `
                },
                "heart-attack": {
                    title: "First Aid ‚Äì Heart Attack",
                    content: `
                        <p><strong>‚ö†Ô∏è IMMEDIATE ACTION REQUIRED:</strong></p>
                        <ol>
                            <li>Call emergency medical services immediately.</li>
                            <li>Have the person sit down, rest, and stay calm.</li>
                            <li>Loosen tight clothing.</li>
                            <li>Ask if the person takes medication for chest pain (like nitroglycerin) for a known heart condition, and help them take it.</li>
                            <li>If the person is unconscious and not breathing, begin CPR.</li>
                            <li>DO NOT leave the person alone (except to call for help).</li>
                            <li>DO NOT let the person eat or drink anything.</li>
                        </ol>
                        <p><strong>Common symptoms:</strong> Chest pain or discomfort, pain in arms/shoulder/back/jaw, shortness of breath, cold sweat, nausea, dizziness.</p>
                    `
                },
                "epilepsy": {
                    title: "First Aid ‚Äì Epilepsy/Seizure",
                    content: `
                        <p><strong>During a seizure:</strong></p>
                        <ol>
                            <li>Stay calm and stay with the person.</li>
                            <li>Time the seizure.</li>
                            <li>Clear the area around the person of hard or sharp objects.</li>
                            <li>Place something soft under their head.</li>
                            <li>Gently turn them onto their side to keep airways clear.</li>
                            <li>DO NOT hold the person down or try to stop their movements.</li>
                            <li>DO NOT put anything in their mouth.</li>
                            <li>DO NOT give water, food, or pills until they are fully awake.</li>
                        </ol>
                        <p><strong>Call for help if:</strong> the seizure lasts more than 5 minutes, a second seizure follows immediately, the person has trouble breathing afterward, an injury occurs during the seizure, or it‚Äôs their first seizure.</p>
                    `
                },
                "stroke": {
                    title: "First Aid ‚Äì Stroke (FAST Method)",
                    content: `
                        <p><strong>‚ö†Ô∏è RECOGNIZE STROKE SYMPTOMS (FAST):</strong></p>
                        <ul>
                            <li><strong>F</strong>ace drooping ‚Äì Is one side of the face drooping?</li>
                            <li><strong>A</strong>rm weakness ‚Äì Is one arm weak or numb?</li>
                            <li><strong>S</strong>peech difficulty ‚Äì Is speech slurred or strange?</li>
                            <li><strong>T</strong>ime to call ‚Äì Note when symptoms first appeared.</li>
                        </ul>
                        <p><strong>Immediate actions:</strong></p>
                        <ol>
                            <li>Call emergency medical services immediately.</li>
                            <li>Note the time symptoms first appeared.</li>
                            <li>Keep the person still and comfortable.</li>
                            <li>DO NOT give medications, food, or drinks.</li>
                            <li>DO NOT let the person fall asleep.</li>
                            <li>If unconscious, check breathing and perform CPR if needed.</li>
                        </ol>
                        <p>Every minute counts ‚Äì prompt treatment can save lives and reduce disability.</p>
                    `
                },
                "burn": {
                    title: "First Aid ‚Äì Burn",
                    content: `
                        <p><strong>Minor burns (first-degree):</strong></p>
                        <ol>
                            <li>Cool the burn under lukewarm (not cold) running water for 10‚Äì15 minutes.</li>
                            <li>Remove tight items from the burned area before swelling starts.</li>
                            <li>Apply a soothing lotion (aloe vera or moisturizer).</li>
                            <li>Cover with a sterile non-stick bandage.</li>
                            <li>Take pain relievers if needed.</li>
                        </ol>
                        <p><strong>Severe burns (second- or third-degree):</strong></p>
                        <ol>
                            <li>Call emergency medical services.</li>
                            <li>Protect the burned person from further injury.</li>
                            <li>DO NOT remove clothing stuck to the burn.</li>
                            <li>DO NOT immerse large severe burns in cold water (risk of hypothermia).</li>
                            <li>Cover the burn with a sterile, moist, cool bandage or clean cloth.</li>
                            <li>Watch for signs of shock (pale, clammy skin, weak pulse, shallow breathing).</li>
                        </ol>
                        <p><strong>Chemical burns:</strong> Rinse continuously with water for at least 20 minutes.</p>
                    `
                },
                "choking": {
                    title: "First Aid ‚Äì Choking",
                    content: `
                        <p><strong>If the person can cough, speak, or breathe:</strong></p>
                        <ul>
                            <li>Encourage them to keep coughing.</li>
                            <li>Do not intervene unless symptoms worsen.</li>
                        </ul>
                        <p><strong>If the person CANNOT cough, speak, or breathe (complete airway obstruction):</strong></p>
                        <ol>
                            <li>Stand behind the person and wrap your arms around their waist.</li>
                            <li>Make a fist with one hand and place it just above the person‚Äôs navel.</li>
                            <li>Grasp your fist with your other hand and perform quick upward abdominal thrusts (Heimlich maneuver).</li>
                            <li>Continue until the object is expelled or the person becomes unconscious.</li>
                            <li>If the person becomes unconscious, begin CPR and check the mouth for the object before rescue breaths.</li>
                        </ol>
                        <p><strong>For infants:</strong> Use back blows and chest thrusts instead of abdominal thrusts.</p>
                    `
                },
                "fracture": {
                    title: "First Aid ‚Äì Fracture",
                    content: `
                        <p><strong>General principles:</strong></p>
                        <ol>
                            <li>Stop any bleeding by applying pressure with a sterile bandage or clean cloth.</li>
                            <li>Immobilize the injured area ‚Äì do not try to realign the bone.</li>
                            <li>Apply ice packs to reduce swelling and relieve pain (wrap ice in a cloth).</li>
                            <li>Treat for shock: lay the person down with head slightly lower than torso and elevate legs if possible.</li>
                            <li>Seek medical care immediately.</li>
                        </ol>
                        <p><strong>For open fractures (bone protruding):</strong></p>
                        <ul>
                            <li>DO NOT push the bone back in.</li>
                            <li>Cover the wound with a sterile dressing.</li>
                            <li>Immobilize the area above and below the fracture site.</li>
                        </ul>
                        <p><strong>Signs of fracture:</strong> deformity, swelling, bruising, intense pain, inability to move limb, grating sensation.</p>
                    `
                }
            };
            // Prevention advice database (fallback content)
            const preventionAdvice = {
                malaria: `
                    <p><strong>5 simple malaria prevention tips:</strong></p>
                    <ol>
                        <li>Always sleep under an insecticide-treated mosquito net, even during daytime naps.</li>
                        <li>Wear long-sleeved shirts and long pants, especially at dusk and dawn.</li>
                        <li>Use skin repellents containing DEET or IR3535 on exposed skin.</li>
                        <li>Eliminate standing water around your home (containers, tires, etc.) where mosquitoes lay eggs.</li>
                        <li>Have indoor walls sprayed with long-lasting insecticides if available in your area.</li>
                    </ol>
                    <p><em>Remember: Prevention is always easier and cheaper than treatment.</em></p>
                `,
                diabetes: `
                    <p><strong>5 simple diabetes prevention tips:</strong></p>
                    <ol>
                        <li>Eat more fresh fruits and vegetables, and reduce sugar and processed foods.</li>
                        <li>Move regularly: walk at least 30 minutes a day, even while doing daily chores.</li>
                        <li>Monitor your weight: even a 5‚Äì10% weight loss can significantly reduce your risk.</li>
                        <li>Limit alcohol and quit smoking if you smoke.</li>
                        <li>Get screened regularly, especially if you have a family history of diabetes.</li>
                    </ol>
                    <p><em>A balanced diet and physical activity are your best allies against diabetes.</em></p>
                `,
                "snake-bite": `
                    <p><strong>3 immediate actions to take after a snake bite:</strong></p>
                    <ol>
                        <li>Keep the victim completely still and calm to slow venom spread.</li>
                        <li>Remove any tight jewelry or clothing near the bite before swelling worsens.</li>
                        <li>Immediately transport the victim to the nearest medical center‚Äîdo not delay!</li>
                    </ol>
                    <p><strong>3 things NEVER to do:</strong></p>
                    <ol>
                        <li>Do NOT cut the wound or try to suck out the venom‚Äîit can make things worse.</li>
                        <li>Do NOT apply a tight tourniquet‚Äîit can cause permanent tissue damage.</li>
                        <li>Do NOT give the victim alcohol, coffee, or medications‚Äîit may speed up venom absorption.</li>
                    </ol>
                    <p><em>Time is critical‚Äîevery minute counts. Go straight to the hospital!</em></p>
                `,
                "child-accidents": `
                    <p><strong>5 tips to prevent household accidents in young children:</strong></p>
                    <ol>
                        <li>Always supervise children near fire, stoves, or containers of hot water to prevent burns.</li>
                        <li>Store medicines, cleaning products, and chemicals out of reach‚Äîideally locked away.</li>
                        <li>Install safety gates at the top and bottom of stairs, and use corner protectors on furniture.</li>
                        <li>Never leave a child alone in water (bathtub, bucket, basin)‚Äîdrowning can happen in seconds.</li>
                        <li>Secure heavy furniture to the wall to prevent tipping if a child tries to climb it.</li>
                    </ol>
                    <p><em>Constant supervision and simple safety measures can save your child‚Äôs life.</em></p>
                `
            };
            // Function to show a screen and hide others
            function showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(screenId).classList.add('active');
            }
            // Tab navigation
            document.querySelectorAll('.tab-btn').forEach(tabBtn => {
                tabBtn.addEventListener('click', () => {
                    // Remove active class from all tabs
                    document.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    // Add active class to clicked tab
                    tabBtn.classList.add('active');
                    // Hide all tab content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    // Show corresponding tab content
                    const tabId = tabBtn.dataset.tab + '-tab';
                    document.getElementById(tabId).classList.add('active');
                });
            });
            // Navigation event handlers
            document.getElementById('start-btn').addEventListener('click', () => {
                showScreen('diagnostic-screen');
            });
            document.getElementById('back-to-home').addEventListener('click', () => {
                showScreen('home-screen');
            });
            document.getElementById('new-diagnosis').addEventListener('click', () => {
                // Reset checkboxes
                document.querySelectorAll('.checkbox').forEach(checkbox => {
                    checkbox.checked = false;
                });
                showScreen('diagnostic-screen');
            });
            document.getElementById('back-to-result').addEventListener('click', () => {
                showScreen('result-screen');
            });
            document.getElementById('back-to-emergency-menu').addEventListener('click', () => {
                showScreen('home-screen');
                // Activate emergency tab
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector('[data-tab="emergency"]').classList.add('active');
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('emergency-tab').classList.add('active');
            });
            // Emergency card click handlers
            document.querySelectorAll('.emergency-card').forEach(card => {
                card.addEventListener('click', () => {
                    const emergencyType = card.dataset.emergency;
                    const advice = emergencyAdvice[emergencyType];
                    document.getElementById('emergency-title').textContent = advice.title;
                    document.getElementById('emergency-content').innerHTML = advice.content;
                    showScreen('emergency-advice-screen');
                });
            });
            // Emergency services button
            document.getElementById('emergency-services').addEventListener('click', () => {
                showServicesScreen();
            });
            // Submit diagnosis
            document.getElementById('submit-diagnosis').addEventListener('click', async () => {
                // Get location
                userLocation = document.getElementById('location-input').value || "Uganda, Kamuli district";
                // Get selected symptoms
                const selectedSymptoms = [];
                document.querySelectorAll('.checkbox:checked').forEach(checkbox => {
                    selectedSymptoms.push(checkbox.dataset.symptom);
                });
                // Check if at least one symptom is selected
                if (selectedSymptoms.length === 0) {
                    alert("Please select at least one symptom.");
                    return;
                }
                // Show loading screen
                showScreen('loading-screen');
                try {
                    // Call Gemini API
                    const aiResponse = await callGeminiAPI(selectedSymptoms, userLocation);
                    displayAIResults(aiResponse);
                } catch (error) {
                    console.error("Error calling Gemini API:", error);
                    // Fallback response if API fails
                    const fallbackResponse = generateFallbackResponse(selectedSymptoms, userLocation);
                    displayAIResults(fallbackResponse);
                }
            });
            // Function to call Gemini API
            async function callGeminiAPI(symptoms, location) {
                const prompt = `As a public health expert in Africa, act as a reliable and non-alarmist medical advisor. A patient in ${location} has the following symptoms: ${symptoms.join(', ')}. Malaria is endemic in this region. The patient does not have access to a healthcare professional. Analyze these symptoms. Provide a possible diagnosis and an estimated likelihood level. Then, give an immediate action plan with clear, region-appropriate advice. Explicitly warn that this is only guidance and that consulting a professional is essential.`;
                try {
                    const response = await fetch(GEMINI_API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: prompt
                                }]
                            }]
                        })
                    });
                    if (!response.ok) {
                        throw new Error(`HTTP Error: ${response.status}`);
                    }
                    const data = await response.json();
                    // Extract AI response
                    if (data.candidates && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0].text) {
                        return data.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error("Unexpected response format");
                    }
                } catch (error) {
                    console.error("Detailed error:", error);
                    throw error;
                }
            }
            // Fallback response function
            function generateFallbackResponse(symptoms, location) {
                let diagnosis = "";
                let advice = "";
                // Simple logic to determine diagnosis based on symptoms
                const hasFever = symptoms.includes("fever");
                const hasHeadache = symptoms.includes("headache");
                const hasMusclePain = symptoms.includes("muscle pain");
                const hasNausea = symptoms.includes("nausea");
                const hasFatigue = symptoms.includes("fatigue");
                // Malaria likely if fever + headache + muscle pain
                if (hasFever && hasHeadache && hasMusclePain) {
                    diagnosis = "High likelihood of malaria";
                    advice = `
                        <p><strong>Recommended immediate actions:</strong></p>
                        <ol>
                            <li>Rest and hydrate well with clean water.</li>
                            <li>If you have antimalarial medication (e.g., artemisinin), take it as directed.</li>
                            <li>Use cold compresses to reduce fever.</li>
                            <li>Sleep under an insecticide-treated mosquito net.</li>
                            <li>Contact a health center immediately‚Äîmalaria can be fatal if not treated quickly.</li>
                        </ol>
                        <p><strong>Future prevention:</strong></p>
                        <ul>
                            <li>Always use a mosquito net while sleeping.</li>
                            <li>Wear long-sleeved clothing at dusk.</li>
                            <li>Eliminate standing water around your home.</li>
                        </ul>
                    `;
                } 
                // Other symptom combinations
                else if (hasFever && (hasNausea || hasFatigue)) {
                    diagnosis = "Moderate likelihood of malaria or other infection";
                    advice = `
                        <p><strong>Recommended immediate actions:</strong></p>
                        <ol>
                            <li>Monitor your temperature regularly.</li>
                            <li>Stay well-hydrated with clean water and oral rehydration solutions.</li>
                            <li>Rest as much as possible.</li>
                            <li>If fever persists beyond 48 hours, visit a health center.</li>
                        </ol>
                        <p><strong>Warning:</strong> In your region, malaria is common. Do not ignore these symptoms.</p>
                    `;
                }
                else if (symptoms.includes("cough") || symptoms.includes("diarrhea")) {
                    diagnosis = "Possible gastrointestinal or respiratory infection";
                    advice = `
                        <p><strong>Recommended immediate actions:</strong></p>
                        <ol>
                            <li>Hydrate well, especially if you have diarrhea.</li>
                            <li>Eat light, easy-to-digest foods.</li>
                            <li>Avoid close contact with others to prevent spreading infection.</li>
                            <li>Wash hands regularly with soap.</li>
                            <li>If symptoms last more than 3 days, consult a healthcare professional.</li>
                        </ol>
                    `;
                }
                else {
                    diagnosis = "Non-specific symptoms ‚Äì monitoring recommended";
                    advice = `
                        <p><strong>General advice:</strong></p>
                        <ol>
                            <li>Continue monitoring your symptoms.</li>
                            <li>Get enough rest and stay well-hydrated.</li>
                            <li>Note any changes in your health condition.</li>
                            <li>If new or worsening symptoms appear, visit a health center.</li>
                        </ol>
                        <p>Remember that in your region, diseases like malaria can progress quickly. Stay alert.</p>
                    `;
                }
                // Add standard medical disclaimer
                advice += `
                    <p style="margin-top: 20px; padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 5px;">
                        <strong>‚ö†Ô∏è Important warning:</strong> This diagnosis is provided by artificial intelligence for informational purposes only. It does not replace professional medical consultation. If in doubt or if symptoms worsen, contact a healthcare professional immediately.
                    </p>
                `;
                return { diagnosis, advice, isFallback: true };
            }
            // Function to display AI results
            function displayAIResults(aiResponse) {
                if (aiResponse.isFallback) {
                    // Use structured fallback response
                    document.getElementById('diagnosis-title').textContent = aiResponse.diagnosis;
                    document.getElementById('diagnosis-content').innerHTML = `<p>Based on your symptoms and location (${userLocation}), our AI system estimates:</p>`;
                    document.getElementById('advice-content').innerHTML = aiResponse.advice;
                } else {
                    // Use Gemini API response
                    document.getElementById('diagnosis-title').textContent = "AI Analysis";
                    document.getElementById('diagnosis-content').innerHTML = `<p>Based on your symptoms and location (${userLocation}):</p>`;
                    document.getElementById('advice-content').innerHTML = `<p>${aiResponse.replace(/\n/g, '<br>')}</p>`;
                }
                // Show results screen
                showScreen('result-screen');
            }
            // Show services screen
            document.getElementById('view-services').addEventListener('click', () => {
                showServicesScreen();
            });
            // Function to show services screen
            function showServicesScreen() {
                // Update location display
                document.getElementById('user-location-display').textContent = userLocation;
                // Calculate nearest center (simulation)
                const nearestCenter = healthCenters[0]; // For simulation, take the first one
                // Generate map centered on nearest center
                const mapUrl = `https://maps.google.com/maps?q=${nearestCenter.lat},${nearestCenter.lng}&z=12&output=embed`;
                document.getElementById('map-iframe').src = mapUrl;
                // Generate health centers list
                const centersList = document.getElementById('health-centers-list');
                centersList.innerHTML = '<h3>üè• Available Health Centers:</h3>';
                healthCenters.forEach(center => {
                    const centerElement = document.createElement('div');
                    centerElement.className = 'health-center';
                    centerElement.innerHTML = `
                        <div class="center-name">${center.name}</div>
                        <div class="center-address">${center.address}</div>
                        <div class="center-phone">üìû ${center.phone}</div>
                        <a href="tel:${center.phone.replace(/\s/g, '')}" class="btn" style="margin-top: 10px; padding: 8px; font-size: 0.9rem;">Call this center</a>
                    `;
                    centersList.appendChild(centerElement);
                });
                showScreen('services-screen');
            }
            // Prevention button click handlers
            document.querySelectorAll('.fluid-button').forEach(button => {
                button.addEventListener('click', function() {
                    const preventionType = this.getAttribute('data-prevention');
                    const topicTitles = {
                        malaria: "Malaria Prevention",
                        diabetes: "Diabetes Prevention",
                        "snake-bite": "First Aid ‚Äì Snake Bites",
                        "child-accidents": "Preventing Household Accidents in Children"
                    };
                    // Show loading
                    document.getElementById('preventionLoading').style.display = 'block';
                    // Simulate API call delay
                    setTimeout(() => {
                        document.getElementById('preventionLoading').style.display = 'none';
                        document.getElementById('preventionModalTitle').textContent = topicTitles[preventionType];
                        document.getElementById('preventionModalContent').innerHTML = preventionAdvice[preventionType];
                        document.getElementById('preventionModal').style.display = 'flex';
                    }, 800);
                });
            });
            // Close prevention modal function
            window.closePreventionModal = function() {
                document.getElementById('preventionModal').style.display = 'none';
            };
            // Close modal when clicking outside
            document.getElementById('preventionModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closePreventionModal();
                }
            });
            // Initialization
            document.getElementById('location-input').value = userLocation;
            // Add keyboard support for better accessibility
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && document.getElementById('preventionModal').style.display === 'flex') {
                    closePreventionModal();
                }
            });
        }
    </script>
</body>
</html>
