<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaniAI - Prototype Complet</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 100%;
            padding: 20px;
        }
        .screen {
            display: none;
            padding: 20px;
            animation: fadeIn 0.3s ease-in-out;
        }
        .screen.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }
        .logo svg {
            width: 40px;
            height: 40px;
            fill: white;
        }
        h1 {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 700;
        }
        h2 {
            font-size: 1.5rem;
            color: #3498db;
            margin-bottom: 20px;
            font-weight: 600;
        }
        h3 {
            font-size: 1.2rem;
            margin: 15px 0 10px;
            color: #2c3e50;
            font-weight: 600;
        }
        h4 {
            font-size: 1.1rem;
            margin: 15px 0 10px;
            color: #27ae60;
            font-weight: 600;
        }
        p {
            font-size: 1rem;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.2s ease;
            box-shadow: 0 3px 10px rgba(79, 172, 254, 0.3);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn-secondary {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            box-shadow: 0 3px 10px rgba(155, 89, 182, 0.3);
        }
        .btn-secondary:hover {
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.4);
        }
        .btn-emergency {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            box-shadow: 0 3px 10px rgba(231, 76, 60, 0.3);
        }
        .btn-emergency:hover {
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        .symptom-container {
            margin-bottom: 20px;
        }
        .symptom-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: all 0.2s ease;
            border: 1px solid #ecf0f1;
        }
        .symptom-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-color: #3498db;
        }
        .symptom-icon {
            width: 40px;
            height: 40px;
            background: #ecf0f1;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: #3498db;
            font-size: 1.2rem;
            transition: all 0.2s;
        }
        .symptom-item:hover .symptom-icon {
            background: #3498db;
            color: white;
        }
        .symptom-label {
            flex: 1;
            font-size: 1rem;
            font-weight: 500;
        }
        .checkbox {
            width: 22px;
            height: 22px;
            accent-color: #3498db;
            cursor: pointer;
        }
        .result-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            border: 1px solid #ecf0f1;
        }
        .diagnosis-title {
            font-size: 1.3rem;
            color: #e74c3c;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f1c40f;
        }
        .advice-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #27ae60;
        }
        .advice-title {
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        .map-container {
            height: 300px;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            border: 1px solid #ecf0f1;
        }
        .health-center {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border: 1px solid #ecf0f1;
            transition: all 0.2s ease;
        }
        .health-center:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .center-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        .center-address {
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        .center-phone {
            color: #3498db;
            font-weight: bold;
            font-size: 1rem;
        }
        .disclaimer {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            font-size: 0.9rem;
            box-shadow: 0 3px 10px rgba(231, 76, 60, 0.3);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        .location-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            font-size: 1rem;
            margin: 20px 0;
            transition: all 0.3s;
            font-weight: 500;
        }
        .location-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #ecf0f1;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .back-btn {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            margin-top: 10px;
            box-shadow: 0 3px 10px rgba(149, 165, 166, 0.3);
        }
        .back-btn:hover {
            box-shadow: 0 5px 15px rgba(149, 165, 166, 0.4);
        }
        .emergency-menu, .prevention-menu {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .emergency-card, .prevention-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #ecf0f1;
        }
        .emergency-card:hover, .prevention-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: #3498db;
        }
        .emergency-icon, .prevention-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }
        .tab-menu {
            display: flex;
            margin-bottom: 20px;
            overflow-x: auto;
            gap: 5px;
            padding-bottom: 10px;
        }
        .tab-btn {
            padding: 12px 20px;
            background: #ecf0f1;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            white-space: nowrap;
            font-weight: 600;
            transition: all 0.2s;
            border-radius: 8px 8px 0 0;
            flex: 1;
            text-align: center;
            min-width: 100px;
        }
        .tab-btn.active {
            background: #3498db;
            color: white;
            border-bottom: 3px solid #2980b9;
            box-shadow: 0 2px 5px rgba(52, 152, 219, 0.2);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        /* Prevention-specific styles */
        .prevention-title {
            text-align: center;
            margin: 25px 0 30px;
            color: #1B5E20;
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .fluid-button {
            background-color: white;
            border: 2px solid #4CAF50;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .fluid-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.12);
            background-color: #F1F8E9;
            border-color: #388E3C;
        }
        
        .fluid-button:active {
            transform: translateY(0);
        }
        
        .button-icon {
            width: 50px;
            height: 50px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            font-size: 1.5rem;
            transition: all 0.2s;
        }
        
        .fluid-button:hover .button-icon {
            background-color: #388E3C;
        }
        
        .button-content {
            flex: 1;
        }
        
        .button-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #1B5E20;
            margin-bottom: 5px;
        }
        
        .button-description {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }
        
        .result-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            animation: slideUp 0.3s ease;
            border: 1px solid #ecf0f1;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .close-modal:hover {
            background: #f8f9fa;
            color: #e74c3c;
        }
        
        .modal-title {
            font-size: 1.4rem;
            color: #1B5E20;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4CAF50;
            font-weight: 600;
        }
        
        .modal-content p {
            margin-bottom: 15px;
            line-height: 1.7;
        }
        
        .modal-content ol, .modal-content ul {
            margin-bottom: 15px;
            padding-left: 20px;
        }
        
        .modal-content li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .prevention-loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .prevention-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left: 4px solid #4CAF50;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            h1 {
                font-size: 1.6rem;
            }
            .btn {
                padding: 14px;
                font-size: 1.05rem;
            }
            .emergency-menu, .prevention-menu {
                grid-template-columns: 1fr;
            }
            .logo {
                width: 70px;
                height: 70px;
            }
            .logo svg {
                width: 35px;
                height: 35px;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            h1 {
                font-size: 1.5rem;
            }
            h2 {
                font-size: 1.3rem;
            }
            .btn {
                padding: 12px;
                font-size: 1rem;
            }
            .symptom-item {
                padding: 12px;
            }
            .symptom-icon {
                width: 35px;
                height: 35px;
                font-size: 1.1rem;
            }
            .result-container {
                padding: 20px;
            }
            .tab-btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            .button-title {
                font-size: 1.1rem;
            }
            .modal-content {
                padding: 20px;
            }
        }
        
        /* Performance optimizations */
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        img, iframe {
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
        }
        
        /* Animation performance */
        .btn, .symptom-item, .emergency-card, .fluid-button, .health-center {
            will-change: transform, box-shadow;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Disclaimer visible on all pages -->
        <div class="disclaimer">
            ‚ö†Ô∏è AVERTISSEMENT : Ce prototype est une simulation et ne doit en aucun cas √™tre utilis√© pour des conseils m√©dicaux r√©els. Consultez toujours un professionnel de la sant√© pour tout probl√®me m√©dical.
        </div>
        
        <!-- Home Screen -->
        <div id="home-screen" class="screen active">
            <div class="header">
                <div class="logo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                    </svg>
                </div>
                <h1>SaniAI</h1>
                <p>Votre assistant sant√© intelligent pour l'Afrique</p>
                <p>Diagnostic rapide et conseils adapt√©s √† votre r√©gion</p>
                <p>Cr√©√© par MUPOLE UWIZEYE ALEXIS</p>
            </div>
            <div class="tab-menu">
                <button class="tab-btn active" data-tab="diagnosis">Diagnostic</button>
                <button class="tab-btn" data-tab="emergency">Urgences</button>
                <button class="tab-btn" data-tab="prevention">Pr√©vention</button>
            </div>
            <div id="diagnosis-tab" class="tab-content active">
                <button id="start-btn" class="btn">D√©marrer le diagnostic</button>
            </div>
            <div id="emergency-tab" class="tab-content">
                <h3>üÜò Guide des Premiers Secours</h3>
                <div class="emergency-menu">
                    <div class="emergency-card" data-emergency="snake-bite">
                        <div class="emergency-icon">üêç</div>
                        <p>Morsure de serpent</p>
                    </div>
                    <div class="emergency-card" data-emergency="dog-bite">
                        <div class="emergency-icon">üêï</div>
                        <p>Morsure de chien</p>
                    </div>
                    <div class="emergency-card" data-emergency="heart-attack">
                        <div class="emergency-icon">‚ù§Ô∏è</div>
                        <p>Crise cardiaque</p>
                    </div>
                    <div class="emergency-card" data-emergency="epilepsy">
                        <div class="emergency-icon">üß†</div>
                        <p>√âpilepsie</p>
                    </div>
                    <div class="emergency-card" data-emergency="stroke">
                        <div class="emergency-icon">ü©∫</div>
                        <p>Accident vasculaire</p>
                    </div>
                    <div class="emergency-card" data-emergency="burn">
                        <div class="emergency-icon">üî•</div>
                        <p>Br√ªlure</p>
                    </div>
                    <div class="emergency-card" data-emergency="choking">
                        <div class="emergency-icon">üòÆ</div>
                        <p>√âtouffement</p>
                    </div>
                    <div class="emergency-card" data-emergency="fracture">
                        <div class="emergency-icon">ü¶¥</div>
                        <p>Fracture</p>
                    </div>
                </div>
            </div>
            <div id="prevention-tab" class="tab-content">
                <h3 class="prevention-title">Prot√©gez votre Sant√© et votre Famille</h3>
                <div class="prevention-menu">
                    <div class="fluid-button" data-prevention="malaria">
                        <div class="button-icon">ü¶ü</div>
                        <div class="button-content">
                            <div class="button-title">Pr√©vention Paludisme</div>
                            <div class="button-description">Apprenez √† vous prot√©ger contre les moustiques</div>
                        </div>
                    </div>
                    
                    <div class="fluid-button" data-prevention="diabetes">
                        <div class="button-icon">üç¨</div>
                        <div class="button-content">
                            <div class="button-title">Pr√©vention Diab√®te</div>
                            <div class="button-description">Adoptez des habitudes alimentaires saines</div>
                        </div>
                    </div>
                    
                    <div class="fluid-button" data-prevention="snake-bite">
                        <div class="button-icon">üêç</div>
                        <div class="button-content">
                            <div class="button-title">Morsures de Serpent</div>
                            <div class="button-description">Agissez rapidement en cas de morsure</div>
                        </div>
                    </div>
                    
                    <div class="fluid-button" data-prevention="child-accidents">
                        <div class="button-icon">üë∂</div>
                        <div class="button-content">
                            <div class="button-title">Accidents Enfants</div>
                            <div class="button-description">Prot√©gez vos enfants √† la maison</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Diagnosis Screen -->
        <div id="diagnostic-screen" class="screen">
            <h2>Auto-Diagnostic</h2>
            <p>Veuillez s√©lectionner vos sympt√¥mes :</p>
            <input type="text" id="location-input" class="location-input" placeholder="Entrez votre localisation (ex: Ouganda, district de Kamuli)" value="Ouganda, district de Kamuli">
            <div class="symptom-container">
                <div class="symptom-item">
                    <div class="symptom-icon">üå°Ô∏è</div>
                    <label class="symptom-label">Fi√®vre ou frissons</label>
                    <input type="checkbox" class="checkbox" data-symptom="fever">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">ü§ï</div>
                    <label class="symptom-label">Maux de t√™te s√©v√®res</label>
                    <input type="checkbox" class="checkbox" data-symptom="headache">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">ü§¢</div>
                    <label class="symptom-label">Naus√©es ou vomissements</label>
                    <input type="checkbox" class="checkbox" data-symptom="nausea">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">üí™</div>
                    <label class="symptom-label">Douleurs musculaires</label>
                    <input type="checkbox" class="checkbox" data-symptom="muscle pain">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">üò¥</div>
                    <label class="symptom-label">Fatigue extr√™me</label>
                    <input type="checkbox" class="checkbox" data-symptom="fatigue">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">ü©∏</div>
                    <label class="symptom-label">Saignements inhabituels</label>
                    <input type="checkbox" class="checkbox" data-symptom="bleeding">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">ü§ß</div>
                    <label class="symptom-label">Toux ou difficult√©s respiratoires</label>
                    <input type="checkbox" class="checkbox" data-symptom="cough">
                </div>
                <div class="symptom-item">
                    <div class="symptom-icon">üíß</div>
                    <label class="symptom-label">Diarrh√©e</label>
                    <input type="checkbox" class="checkbox" data-symptom="diarrhea">
                </div>
            </div>
            <button id="submit-diagnosis" class="btn">Analyser mes sympt√¥mes</button>
            <button id="back-to-home" class="btn back-btn">Retour</button>
        </div>
        
        <!-- Loading Screen -->
        <div id="loading-screen" class="screen">
            <div class="loading">
                <div class="spinner"></div>
                <p>Analyse en cours... Notre IA √©value vos sympt√¥mes</p>
                <p>Cela peut prendre quelques secondes</p>
            </div>
        </div>
        
        <!-- Results Screen -->
        <div id="result-screen" class="screen">
            <h2>R√©sultats du Diagnostic</h2>
            <div class="result-container">
                <div class="diagnosis-title" id="diagnosis-title">Diagnostic Pr√©liminaire</div>
                <div id="diagnosis-content">
                    <!-- AI-generated content will be inserted here -->
                </div>
                <div class="advice-section">
                    <div class="advice-title">üìã Plan d'Action Recommand√© :</div>
                    <div id="advice-content">
                        <!-- AI-generated advice will be inserted here -->
                    </div>
                </div>
            </div>
            <button id="view-services" class="btn">Trouver des services de sant√© √† proximit√©</button>
            <button id="new-diagnosis" class="btn back-btn">Nouveau diagnostic</button>
        </div>
        
        <!-- Emergency Advice Screen -->
        <div id="emergency-advice-screen" class="screen">
            <h2 id="emergency-title">Premiers Secours en Urgence</h2>
            <div class="result-container">
                <div id="emergency-content">
                    <!-- Emergency advice content will be inserted here -->
                </div>
            </div>
            <button id="back-to-emergency-menu" class="btn back-btn">Retour au Guide des Urgences</button>
            <button id="emergency-services" class="btn btn-emergency">Trouver des Services d'Urgence</button>
        </div>
        
        <!-- Prevention Advice Modal -->
        <div class="result-modal" id="preventionModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closePreventionModal()">&times;</button>
                <h2 class="modal-title" id="preventionModalTitle">Conseils de Pr√©vention</h2>
                <div id="preventionModalContent">
                    <!-- Content will be inserted here by JavaScript -->
                </div>
                <button class="btn back-btn" onclick="closePreventionModal()" style="margin-top: 15px;">Fermer</button>
            </div>
        </div>
        
        <!-- Prevention Loading -->
        <div class="prevention-loading" id="preventionLoading">
            <div class="prevention-spinner"></div>
            <p>Recherche de conseils personnalis√©s...</p>
        </div>
        
        <!-- Services Screen -->
        <div id="services-screen" class="screen">
            <h2>Services de Sant√© √† Proximit√©</h2>
            <p>Voici les centres m√©dicaux pr√®s de <span id="user-location-display"></span></p>
            <div class="map-container">
                <iframe id="map-iframe" width="100%" height="100%" frameborder="0" style="border:0" allowfullscreen></iframe>
            </div>
            <div id="health-centers-list">
                <!-- Health centers list will be generated here -->
            </div>
            <button id="back-to-result" class="btn back-btn">Retour aux R√©sultats</button>
        </div>
    </div>
    
    <script>
        // Performance optimization - defer non-critical operations
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize app after page load
            initApp();
        });
        
        function initApp() {
            // Gemini API Key
            const GEMINI_API_KEY = "AIzaSyCitXohWZsQ1ZiJRWunf6pJ80-B-PE5jPg";
            const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`;
            
            // Simulated geolocation
            let userLocation = "Ouganda, district de Kamuli";
            
            // Simulated database of health centers
            const healthCenters = [
                {
                    name: "Centre de Sant√© de Kamuli",
                    address: "Kamuli Town, Ouganda",
                    phone: "+256 456 789 012",
                    lat: 0.9275,
                    lng: 33.1181
                },
                {
                    name: "H√¥pital St. Joseph",
                    address: "Buluya, District de Kamuli",
                    phone: "+256 456 789 013",
                    lat: 0.9562,
                    lng: 33.1458
                },
                {
                    name: "Clinique Rurale d'Iringa",
                    address: "Village d'Iringa, Kamuli",
                    phone: "+256 456 789 014",
                    lat: 0.8954,
                    lng: 33.0876
                },
                {
                    name: "Dispensaire de Nawanyago",
                    address: "Nawanyago, District de Kamuli",
                    phone: "+256 456 789 015",
                    lat: 0.9123,
                    lng: 33.1765
                }
            ];
            
            // Emergency advice database
            const emergencyAdvice = {
                "snake-bite": {
                    title: "Premiers Secours - Morsure de Serpent",
                    content: `
                        <p><strong>‚ö†Ô∏è ACTION IMM√âDIATE REQUISE :</strong></p>
                        <ol>
                            <li>Gardez la personne calme et immobile. Le mouvement augmente la propagation du venin.</li>
                            <li>Retirez les v√™tements ou bijoux serr√©s pr√®s de la zone de la morsure.</li>
                            <li>Gardez la zone mordue en dessous du niveau du c≈ìur si possible.</li>
                            <li>Nettoyez doucement la plaie avec du savon et de l'eau si disponible.</li>
                            <li>Appliquez un bandage l√©ger au-dessus de la morsure (pas trop serr√© - vous devriez pouvoir glisser un doigt dessous).</li>
                            <li>NE COUPEZ PAS la plaie, n'aspirez PAS le venin, n'appliquez PAS de glace, et n'utilisez PAS de garrot.</li>
                            <li>Allez imm√©diatement √† l'h√¥pital - un antivenin peut √™tre n√©cessaire.</li>
                            <li>Si possible, prenez une photo du serpent (√† distance s√ªre) pour aider √† l'identifier.</li>
                        </ol>
                        <p><strong>Pr√©vention :</strong></p>
                        <ul>
                            <li>Portez des bottes en marchant dans les zones herbeuses</li>
                            <li>Utilisez une lampe de poche la nuit</li>
                            <li>Soyez prudent en ramassant du bois ou en atteignant des zones sombres</li>
                        </ul>
                    `
                },
                "dog-bite": {
                    title: "Premiers Secours - Morsure de Chien",
                    content: `
                        <p><strong>‚ö†Ô∏è ACTION IMM√âDIATE REQUISE :</strong></p>
                        <ol>
                            <li>Lavez imm√©diatement la plaie avec du savon et de l'eau courante pendant au moins 5 minutes.</li>
                            <li>Appliquez une pression douce avec un chiffon propre pour arr√™ter le saignement.</li>
                            <li>Appliquez une pommade antibiotique si disponible.</li>
                            <li>Couvrez avec un bandage st√©rile.</li>
                            <li>Consultez imm√©diatement un professionnel de sant√© - un vaccin antirabique peut √™tre n√©cessaire.</li>
                            <li>Essayez d'obtenir des informations sur le statut vaccinal du chien si possible.</li>
                            <li>Signalez la morsure aux autorit√©s locales de contr√¥le des animaux.</li>
                        </ol>
                        <p><strong>Surveillez les signes d'infection :</strong> rougeur, gonflement, douleur accrue, fi√®vre.</p>
                    `
                },
                "heart-attack": {
                    title: "Premiers Secours - Crise Cardiaque",
                    content: `
                        <p><strong>‚ö†Ô∏è ACTION IMM√âDIATE REQUISE :</strong></p>
                        <ol>
                            <li>Appelez imm√©diatement les services m√©dicaux d'urgence.</li>
                            <li>Faites asseoir la personne, qu'elle se repose et essaie de rester calme.</li>
                            <li>Desserrez les v√™tements serr√©s.</li>
                            <li>Demander si la personne prend des m√©dicaments pour la douleur thoracique (comme la nitroglyc√©rine) pour une affection cardiaque connue, et aidez-la √† les prendre.</li>
                            <li>Si la personne est inconsciente et ne respire pas, commencez la RCP.</li>
                            <li>NE laissez PAS la personne seule (sauf pour appeler √† l'aide).</li>
                            <li>NE permettez PAS √† la personne de manger ou de boire quoi que ce soit.</li>
                        </ol>
                        <p><strong>Sympt√¥mes courants :</strong> Douleur ou g√™ne thoracique, douleur dans les bras/√©paule/dos/jaw, essoufflement, sueur froide, naus√©e, √©tourdissement.</p>
                    `
                },
                "epilepsy": {
                    title: "Premiers Secours - √âpilepsie/Crise",
                    content: `
                        <p><strong>Pendant une crise :</strong></p>
                        <ol>
                            <li>Restez calme et restez avec la personne.</li>
                            <li>Chronom√©trez la crise.</li>
                            <li>D√©gager la zone autour de la personne de tout objet dur ou pointu.</li>
                            <li>Placez quelque chose de doux sous sa t√™te.</li>
                            <li>Tournez-la doucement sur le c√¥t√© pour garder les voies respiratoires d√©gag√©es.</li>
                            <li>NE maintenez PAS la personne au sol ou n'essayez PAS d'arr√™ter ses mouvements.</li>
                            <li>NE mettez RIEN dans sa bouche.</li>
                            <li>NE donnez PAS d'eau, de nourriture ou de pilules jusqu'√† ce qu'elle soit compl√®tement r√©veill√©e.</li>
                        </ol>
                        <p><strong>Appelez les secours si :</strong> la crise dure plus de 5 minutes, une deuxi√®me crise suit imm√©diatement, la personne a des difficult√©s √† respirer apr√®s, une blessure survient pendant la crise, ou si c'est sa premi√®re crise.</p>
                    `
                },
                "stroke": {
                    title: "Premiers Secours - Accident Vasculaire C√©r√©bral (M√©thode VITE)",
                    content: `
                        <p><strong>‚ö†Ô∏è RECONNA√éTRE LES SYMPT√îMES D'AVC (VITE) :</strong></p>
                        <ul>
                            <li><strong>V</strong>isage tombant - Un c√¥t√© du visage tombe-t-il ?</li>
                            <li><strong>I</strong>mmobilit√© du bras - Un bras est-il faible ou engourdi ?</li>
                            <li><strong>T</strong>rouble de la parole - La parole est-elle p√¢teuse ou √©trange ?</li>
                            <li><strong>E</strong>n urgence - Notez quand les sympt√¥mes ont commenc√©.</li>
                        </ul>
                        <p><strong>Actions imm√©diates :</strong></p>
                        <ol>
                            <li>Appelez imm√©diatement les services m√©dicaux d'urgence.</li>
                            <li>Notez l'heure √† laquelle les sympt√¥mes sont apparus pour la premi√®re fois.</li>
                            <li>Gardez la personne immobile et confortable.</li>
                            <li>NE donnez PAS de m√©dicaments, de nourriture ou de boissons.</li>
                            <li>NE laissez PAS la personne s'endormir.</li>
                            <li>Si elle est inconsciente, v√©rifiez la respiration et effectuez la RCP si n√©cessaire.</li>
                        </ol>
                        <p>Chaque minute compte - un traitement rapide peut sauver des vies et r√©duire l'invalidit√©.</p>
                    `
                },
                "burn": {
                    title: "Premiers Secours - Br√ªlure",
                    content: `
                        <p><strong>Br√ªlures mineures (premier degr√©) :</strong></p>
                        <ol>
                            <li>Refroidissez la br√ªlure sous un filet d'eau ti√®de (pas froide) pendant 10-15 minutes.</li>
                            <li>Retirez les objets serr√©s de la zone br√ªl√©e avant que l'enflure n'apparaisse.</li>
                            <li>Appliquez une lotion apaisante (aloe vera ou hydratant).</li>
                            <li>Couvrez avec un bandage st√©rile non adh√©sif.</li>
                            <li>Prenez des analg√©siques si n√©cessaire.</li>
                        </ol>
                        <p><strong>Br√ªlures graves (deuxi√®me ou troisi√®me degr√©) :</strong></p>
                        <ol>
                            <li>Appelez les services m√©dicaux d'urgence.</li>
                            <li>Prot√©gez la personne br√ªl√©e contre d'autres blessures.</li>
                            <li>NE retirez PAS les v√™tements coll√©s √† la br√ªlure.</li>
                            <li>NE plongez PAS les grandes br√ªlures graves dans de l'eau froide (peut provoquer une hypothermie).</li>
                            <li>Couvrez la br√ªlure avec un bandage st√©rile, humide et frais ou un chiffon propre.</li>
                            <li>Surveillez les signes de choc (peau p√¢le et moite, pouls faible, respiration superficielle).</li>
                        </ol>
                        <p><strong>Br√ªlures chimiques :</strong> Rincez continuellement √† l'eau pendant au moins 20 minutes.</p>
                    `
                },
                "choking": {
                    title: "Premiers Secours - √âtouffement",
                    content: `
                        <p><strong>Si la personne peut tousser, parler ou respirer :</strong></p>
                        <ul>
                            <li>Encouragez-la √† continuer √† tousser.</li>
                            <li>Ne vous m√™lez pas sauf si les sympt√¥mes s'aggravent.</li>
                        </ul>
                        <p><strong>Si la personne ne peut PAS tousser, parler ou respirer (obstruction compl√®te des voies respiratoires) :</strong></p>
                        <ol>
                            <li>Placez-vous derri√®re la personne et passez vos bras autour de sa taille.</li>
                            <li>Faites un poing avec une main et placez-le l√©g√®rement au-dessus du nombril de la personne.</li>
                            <li>Saisissez le poing avec votre autre main et effectuez des pressions abdominales rapides vers le haut (man≈ìuvre de Heimlich).</li>
                            <li>Continuez jusqu'√† ce que l'objet soit expuls√© ou que la personne devienne inconsciente.</li>
                            <li>Si la personne devient inconsciente, commencez la RCP et v√©rifiez la bouche pour l'objet avant les insufflations.</li>
                        </ol>
                        <p><strong>Pour les nourrissons :</strong> Utilisez des claques dans le dos et des compressions thoraciques au lieu des pressions abdominales.</p>
                    `
                },
                "fracture": {
                    title: "Premiers Secours - Fracture",
                    content: `
                        <p><strong>Principes g√©n√©raux :</strong></p>
                        <ol>
                            <li>Arr√™tez tout saignement en appliquant une pression avec un bandage st√©rile ou un chiffon propre.</li>
                            <li>Immobilisez la zone bless√©e - n'essayez pas de r√©aligner l'os.</li>
                            <li>Appliquez des poches de glace pour limiter l'enflure et aider √† soulager la douleur (enveloppez la glace dans un chiffon).</li>
                            <li>Traitez le choc : allongez la personne avec la t√™te l√©g√®rement plus basse que le torse et √©levez les jambes si possible.</li>
                            <li>Consultez imm√©diatement un professionnel de sant√©.</li>
                        </ol>
                        <p><strong>Pour les fractures ouvertes (os qui d√©passe) :</strong></p>
                        <ul>
                            <li>NE poussez PAS l'os √† l'int√©rieur.</li>
                            <li>Couvrez la plaie avec un pansement st√©rile.</li>
                            <li>Immobilisez la zone au-dessus et en dessous du site de fracture.</li>
                        </ul>
                        <p><strong>Signes de fracture :</strong> d√©formation, gonflement, ecchymose, douleur intense, incapacit√© √† bouger le membre, sensation de grincement.</p>
                    `
                }
            };
            
            // Prevention advice database (fallback content)
            const preventionAdvice = {
                malaria: `
                    <p><strong>5 conseils de pr√©vention simples contre le paludisme :</strong></p>
                    <ol>
                        <li>Dormez toujours sous une moustiquaire impr√©gn√©e d'insecticide, m√™me pendant la sieste.</li>
                        <li>Portez des v√™tements √† manches longues et pantalons longs, surtout au cr√©puscule et √† l'aube.</li>
                        <li>Utilisez des r√©pulsifs cutan√©s contenant du DEET ou de l'IR3535 sur les parties expos√©es de votre corps.</li>
                        <li>√âliminez les eaux stagnantes autour de votre maison (r√©cipients, pneus, etc.) o√π les moustiques pondent leurs ≈ìufs.</li>
                        <li>Faites pulv√©riser les murs int√©rieurs de votre maison avec des insecticides √† effet r√©manent, si disponible dans votre r√©gion.</li>
                    </ol>
                    <p><em>Rappelez-vous : La pr√©vention est toujours plus facile et moins co√ªteuse que le traitement.</em></p>
                `,
                diabetes: `
                    <p><strong>5 conseils de pr√©vention simples contre le diab√®te :</strong></p>
                    <ol>
                        <li>Mangez plus de l√©gumes et de fruits frais, et r√©duisez la consommation de sucre et d'aliments transform√©s.</li>
                        <li>Bougez r√©guli√®rement : marchez au moins 30 minutes par jour, m√™me en faisant vos t√¢ches quotidiennes.</li>
                        <li>Contr√¥lez votre poids : m√™me une perte de 5-10% de votre poids actuel peut r√©duire consid√©rablement votre risque.</li>
                        <li>Limitez la consommation d'alcool et arr√™tez de fumer si vous fumez.</li>
                        <li>Faites-vous d√©pister r√©guli√®rement, surtout si vous avez des ant√©c√©dents familiaux de diab√®te.</li>
                    </ol>
                    <p><em>Une alimentation √©quilibr√©e et l'activit√© physique sont vos meilleurs alli√©s contre le diab√®te.</em></p>
                `,
                "snake-bite": `
                    <p><strong>3 premi√®res actions √† faire en cas de morsure de serpent :</strong></p>
                    <ol>
                        <li>Gardez la victime compl√®tement immobile et calme pour ralentir la propagation du venin.</li>
                        <li>Retirez tout bijou ou v√™tement serr√© pr√®s de la zone mordue avant que le gonflement ne s'aggrave.</li>
                        <li>Transportez imm√©diatement la victime vers le centre m√©dical le plus proche - ne perdez pas de temps !</li>
                    </ol>
                    
                    <p><strong>3 choses √† NE JAMAIS faire :</strong></p>
                    <ol>
                        <li>Ne coupez PAS la plaie et n'essayez PAS d'aspirer le venin - cela peut aggraver la situation.</li>
                        <li>Ne mettez PAS de garrot serr√© - cela peut causer des dommages tissulaires permanents.</li>
                        <li>Ne donnez PAS d'alcool, de caf√© ou de m√©dicaments √† la victime - cela peut acc√©l√©rer l'absorption du venin.</li>
                    </ol>
                    <p><em>Le temps est crucial - chaque minute compte. Allez directement √† l'h√¥pital !</em></p>
                `,
                "child-accidents": `
                    <p><strong>5 conseils pour pr√©venir les accidents domestiques chez les jeunes enfants :</strong></p>
                    <ol>
                        <li>Surveillez constamment les enfants pr√®s du feu, des r√©chauds ou des r√©cipients d'eau chaude pour √©viter les br√ªlures.</li>
                        <li>Rangez les m√©dicaments, produits de nettoyage et produits chimiques hors de port√©e, id√©alement sous cl√©.</li>
                        <li>Installez des barri√®res de s√©curit√© en haut et en bas des escaliers, et utilisez des prot√®ge-angles sur les meubles.</li>
                        <li>Ne laissez jamais un enfant seul dans l'eau (baignoire, seau, bassin) - la noyade peut survenir en quelques secondes.</li>
                        <li>Attachez les meubles lourds au mur pour √©viter qu'ils ne basculent si l'enfant essaie de grimper dessus.</li>
                    </ol>
                    <p><em>La vigilance constante et quelques am√©nagements simples peuvent sauver la vie de votre enfant.</em></p>
                `
            };
            
            // Function to show a screen and hide others
            function showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(screenId).classList.add('active');
            }
            
            // Tab navigation
            document.querySelectorAll('.tab-btn').forEach(tabBtn => {
                tabBtn.addEventListener('click', () => {
                    // Remove active class from all tabs
                    document.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    // Add active class to clicked tab
                    tabBtn.classList.add('active');
                    // Hide all tab content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    // Show corresponding tab content
                    const tabId = tabBtn.dataset.tab + '-tab';
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Navigation event handlers
            document.getElementById('start-btn').addEventListener('click', () => {
                showScreen('diagnostic-screen');
            });
            
            document.getElementById('back-to-home').addEventListener('click', () => {
                showScreen('home-screen');
            });
            
            document.getElementById('new-diagnosis').addEventListener('click', () => {
                // Reset checkboxes
                document.querySelectorAll('.checkbox').forEach(checkbox => {
                    checkbox.checked = false;
                });
                showScreen('diagnostic-screen');
            });
            
            document.getElementById('back-to-result').addEventListener('click', () => {
                showScreen('result-screen');
            });
            
            document.getElementById('back-to-emergency-menu').addEventListener('click', () => {
                showScreen('home-screen');
                // Activate emergency tab
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector('[data-tab="emergency"]').classList.add('active');
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('emergency-tab').classList.add('active');
            });
            
            // Emergency card click handlers
            document.querySelectorAll('.emergency-card').forEach(card => {
                card.addEventListener('click', () => {
                    const emergencyType = card.dataset.emergency;
                    const advice = emergencyAdvice[emergencyType];
                    document.getElementById('emergency-title').textContent = advice.title;
                    document.getElementById('emergency-content').innerHTML = advice.content;
                    showScreen('emergency-advice-screen');
                });
            });
            
            // Emergency services button
            document.getElementById('emergency-services').addEventListener('click', () => {
                showServicesScreen();
            });
            
            // Submit diagnosis
            document.getElementById('submit-diagnosis').addEventListener('click', async () => {
                // Get location
                userLocation = document.getElementById('location-input').value || "Ouganda, district de Kamuli";
                // Get selected symptoms
                const selectedSymptoms = [];
                document.querySelectorAll('.checkbox:checked').forEach(checkbox => {
                    selectedSymptoms.push(checkbox.dataset.symptom);
                });
                // Check if at least one symptom is selected
                if (selectedSymptoms.length === 0) {
                    alert("Veuillez s√©lectionner au moins un sympt√¥me.");
                    return;
                }
                // Show loading screen
                showScreen('loading-screen');
                try {
                    // Call Gemini API
                    const aiResponse = await callGeminiAPI(selectedSymptoms, userLocation);
                    displayAIResults(aiResponse);
                } catch (error) {
                    console.error("Erreur lors de l'appel √† l'API Gemini:", error);
                    // Fallback response if API fails
                    const fallbackResponse = generateFallbackResponse(selectedSymptoms, userLocation);
                    displayAIResults(fallbackResponse);
                }
            });
            
            // Function to call Gemini API
            async function callGeminiAPI(symptoms, location) {
                const prompt = `En tant qu'expert en sant√© publique en Afrique, agissez en tant qu'un conseiller m√©dical fiable et non-alarmiste. Un patient dans le ${location} a les sympt√¥mes suivants : ${symptoms.join(', ')}. La malaria est end√©mique dans cette r√©gion. Le patient n'a pas acc√®s √† un professionnel de la sant√©. Analysez ces sympt√¥mes. Donnez un diagnostic possible et un niveau de probabilit√© estim√©. Ensuite, fournissez un plan d'action imm√©diat avec des conseils clairs, adapt√©s √† la r√©gion. Avertissez explicitement que ceci n'est qu'un avis et que la consultation d'un professionnel est indispensable.`;
                try {
                    const response = await fetch(GEMINI_API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: prompt
                                }]
                            }]
                        })
                    });
                    if (!response.ok) {
                        throw new Error(`Erreur HTTP: ${response.status}`);
                    }
                    const data = await response.json();
                    // Extract AI response
                    if (data.candidates && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0].text) {
                        return data.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error("Format de r√©ponse inattendu");
                    }
                } catch (error) {
                    console.error("Erreur d√©taill√©e:", error);
                    throw error;
                }
            }
            
            // Fallback response function
            function generateFallbackResponse(symptoms, location) {
                let diagnosis = "";
                let advice = "";
                // Simple logic to determine diagnosis based on symptoms
                const hasFever = symptoms.includes("fever");
                const hasHeadache = symptoms.includes("headache");
                const hasMusclePain = symptoms.includes("muscle pain");
                const hasNausea = symptoms.includes("nausea");
                const hasFatigue = symptoms.includes("fatigue");
                // Malaria likely if fever + headache + muscle pain
                if (hasFever && hasHeadache && hasMusclePain) {
                    diagnosis = "Probabilit√© √©lev√©e de paludisme";
                    advice = `
                        <p><strong>Actions imm√©diates recommand√©es :</strong></p>
                        <ol>
                            <li>Reposez-vous et hydratez-vous abondamment avec de l'eau propre.</li>
                            <li>Si vous avez des m√©dicaments antipaludiques (comme l'art√©misinine), prenez-les comme indiqu√©.</li>
                            <li>Utilisez des compresses froides pour r√©duire la fi√®vre.</li>
                            <li>Dormez sous une moustiquaire impr√©gn√©e d'insecticide.</li>
                            <li>Contactez imm√©diatement un centre de sant√© - le paludisme peut √™tre fatal s'il n'est pas trait√© rapidement.</li>
                        </ol>
                        <p><strong>Pr√©vention future :</strong></p>
                        <ul>
                            <li>Utilisez toujours une moustiquaire en dormant.</li>
                            <li>Portez des v√™tements √† manches longues au cr√©puscule.</li>
                            <li>√âliminez les eaux stagnantes autour de votre maison.</li>
                        </ul>
                    `;
                } 
                // Other symptom combinations
                else if (hasFever && (hasNausea || hasFatigue)) {
                    diagnosis = "Probabilit√© mod√©r√©e de paludisme ou autre infection";
                    advice = `
                        <p><strong>Actions imm√©diates recommand√©es :</strong></p>
                        <ol>
                            <li>Surveillez r√©guli√®rement votre temp√©rature.</li>
                            <li>Hydratez-vous fr√©quemment avec de l'eau propre et des solutions de r√©hydratation orale.</li>
                            <li>Reposez-vous autant que possible.</li>
                            <li>Si la fi√®vre persiste plus de 48 heures, consultez un centre de sant√©.</li>
                        </ol>
                        <p><strong>Avertissement :</strong> Dans votre r√©gion, le paludisme est courant. Ne n√©gligez pas ces sympt√¥mes.</p>
                    `;
                }
                else if (symptoms.includes("cough") || symptoms.includes("diarrhea")) {
                    diagnosis = "Infection gastro-intestinale ou respiratoire possible";
                    advice = `
                        <p><strong>Actions imm√©diates recommand√©es :</strong></p>
                        <ol>
                            <li>Hydratez-vous abondamment, surtout si vous avez de la diarrh√©e.</li>
                            <li>Mangez des aliments l√©gers et faciles √† dig√©rer.</li>
                            <li>√âvitez les contacts √©troits avec d'autres personnes pour √©viter la propagation de l'infection.</li>
                            <li>Lavez-vous r√©guli√®rement les mains avec du savon.</li>
                            <li>Si les sympt√¥mes persistent plus de 3 jours, consultez un professionnel de sant√©.</li>
                        </ol>
                    `;
                }
                else {
                    diagnosis = "Sympt√¥mes non sp√©cifiques - surveillance recommand√©e";
                    advice = `
                        <p><strong>Conseils g√©n√©raux :</strong></p>
                        <ol>
                            <li>Continuez √† surveiller vos sympt√¥mes.</li>
                            <li>Reposez-vous suffisamment et maintenez une bonne hydratation.</li>
                            <li>Notez tout changement dans votre √©tat de sant√©.</li>
                            <li>Si de nouveaux sympt√¥mes apparaissent ou s'aggravent, consultez un centre de sant√©.</li>
                        </ol>
                        <p>Rappelez-vous que dans votre r√©gion, des maladies comme le paludisme peuvent se d√©velopper rapidement. Restez vigilant.</p>
                    `;
                }
                // Add standard medical disclaimer
                advice += `
                    <p style="margin-top: 20px; padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 5px;">
                        <strong>‚ö†Ô∏è Avertissement important :</strong> Ce diagnostic est fourni par une intelligence artificielle √† des fins informatives uniquement. Il ne remplace pas la consultation m√©dicale professionnelle. En cas de doute ou d'aggravation des sympt√¥mes, contactez imm√©diatement un professionnel de sant√©.
                    </p>
                `;
                return { diagnosis, advice, isFallback: true };
            }
            
            // Function to display AI results
            function displayAIResults(aiResponse) {
                if (aiResponse.isFallback) {
                    // Use structured fallback response
                    document.getElementById('diagnosis-title').textContent = aiResponse.diagnosis;
                    document.getElementById('diagnosis-content').innerHTML = `<p>Bas√© sur vos sympt√¥mes et votre localisation (${userLocation}), notre syst√®me IA estime :</p>`;
                    document.getElementById('advice-content').innerHTML = aiResponse.advice;
                } else {
                    // Use Gemini API response
                    document.getElementById('diagnosis-title').textContent = "Analyse IA";
                    document.getElementById('diagnosis-content').innerHTML = `<p>Bas√© sur vos sympt√¥mes et votre localisation (${userLocation}) :</p>`;
                    document.getElementById('advice-content').innerHTML = `<p>${aiResponse.replace(/\n/g, '<br>')}</p>`;
                }
                // Show results screen
                showScreen('result-screen');
            }
            
            // Show services screen
            document.getElementById('view-services').addEventListener('click', () => {
                showServicesScreen();
            });
            
            // Function to show services screen
            function showServicesScreen() {
                // Update location display
                document.getElementById('user-location-display').textContent = userLocation;
                // Calculate nearest center (simulation)
                const nearestCenter = healthCenters[0]; // For simulation, take the first one
                // Generate map centered on nearest center
                const mapUrl = `https://maps.google.com/maps?q=${nearestCenter.lat},${nearestCenter.lng}&z=12&output=embed`;
                document.getElementById('map-iframe').src = mapUrl;
                // Generate health centers list
                const centersList = document.getElementById('health-centers-list');
                centersList.innerHTML = '<h3>üè• Centres de Sant√© Disponibles :</h3>';
                healthCenters.forEach(center => {
                    const centerElement = document.createElement('div');
                    centerElement.className = 'health-center';
                    centerElement.innerHTML = `
                        <div class="center-name">${center.name}</div>
                        <div class="center-address">${center.address}</div>
                        <div class="center-phone">üìû ${center.phone}</div>
                        <a href="tel:${center.phone.replace(/\s/g, '')}" class="btn" style="margin-top: 10px; padding: 8px; font-size: 0.9rem;">Appeler ce centre</a>
                    `;
                    centersList.appendChild(centerElement);
                });
                showScreen('services-screen');
            }
            
            // Prevention button click handlers
            document.querySelectorAll('.fluid-button').forEach(button => {
                button.addEventListener('click', function() {
                    const preventionType = this.getAttribute('data-prevention');
                    const topicTitles = {
                        malaria: "Pr√©vention du Paludisme",
                        diabetes: "Pr√©vention du Diab√®te",
                        "snake-bite": "Premiers Secours - Morsures de Serpent",
                        "child-accidents": "Pr√©vention des Accidents Domestiques chez les Enfants"
                    };
                    
                    // Show loading
                    document.getElementById('preventionLoading').style.display = 'block';
                    
                    // Simulate API call delay
                    setTimeout(() => {
                        document.getElementById('preventionLoading').style.display = 'none';
                        document.getElementById('preventionModalTitle').textContent = topicTitles[preventionType];
                        document.getElementById('preventionModalContent').innerHTML = preventionAdvice[preventionType];
                        document.getElementById('preventionModal').style.display = 'flex';
                    }, 800);
                });
            });
            
            // Close prevention modal function
            window.closePreventionModal = function() {
                document.getElementById('preventionModal').style.display = 'none';
            };
            
            // Close modal when clicking outside
            document.getElementById('preventionModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closePreventionModal();
                }
            });
            
            // Initialization
            document.getElementById('location-input').value = userLocation;
            
            // Add keyboard support for better accessibility
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && document.getElementById('preventionModal').style.display === 'flex') {
                    closePreventionModal();
                }
            });
        }
    </script>
</body>
</html>
